# 时间切片照片生成器（Windows 版）

### 一款专为 Windows 系统设计的时间切片照片生成工具，支持多种切片算法，可将一系列连续拍摄的照片合成为时间切片效果。

## 功能特点

✅ **9 种切片类型**：垂直/水平/圆形扇形/椭圆形扇形/环带类/S型曲线等

✅ **自定义排序规则**：支持按文件名、创建时间、修改时间排序

✅ **智能输出文件命名**：自定义基础名称、添加时间戳、添加切片类型、多种格式输出

✅ **主题切换**：浅色模式（默认）/深色模式（菜单带选中标记✓）

✅ **语言切换**：中文（默认）/English（菜单带选中标记✓）

✅ **完成后可自动打开**生成的图片

✅ **错误日志实时输出**，便于问题排查

## 环境要求

**操作系统**：Windows 10/11（32/64 位均可）

**Python**：3.7+

**依赖库**：PyQt5、Pillow、numpy、tqdm、rawpy（可选，用于处理 RAW 格式图片）

## 安装步骤

### 1. 克隆/下载项目
```bash
git clone https://github.com/KEAIQIUQIU/PhotoTimeSlice.git
cd PhotoTimeSlice
```

### 2. 安装依赖
```bash
pip install pyqt5 pillow numpy tqdm rawpy
```

## 使用方法

### 方式 1：图形界面（推荐）

#### 运行 GUI 程序：
```bash
python gui.py
```

#### GUI 界面说明：
1. **输入设置**：选择输入和输出目录
2. **切片设置**：
   - 选择切片类型（9种可选）
   - 设置位置（根据切片类型自动调整）
   - 选择排序规则
   - 设置线性模式（针对不同类型有不同作用）
3. **输出文件命名**：
   - 设置基础名称
   - 选择文件格式
   - 添加时间戳/切片类型（可选）
4. **生成**：点击"生成时间切片"开始处理

### 方式 2：命令行（CLI）

#### 基本用法：
```bash
python cli.py -i 输入目录 -o 输出目录 -t 切片类型
```

#### 完整参数示例：
```bash
python cli.py -i ./input_photos -o ./output -t vertical -p center --sort-by name --output-name vacation --include-timestamp --include-slice-type --extension jpg
```

#### CLI 参数说明：

| 参数 | 简写 | 说明 | 默认值 | 可选值 |
|------|------|------|--------|--------|
| `--input` | `-i` | 输入文件夹路径 | `"input"` | 任何有效路径 |
| `--output` | `-o` | 输出文件夹路径 | `"output"` | 任何有效路径 |
| `--type` | `-t` | **切片类型（必需）** | - | `vertical`, `horizontal`, `circular_sector`, `elliptical_sector`, `elliptical_band`, `rectangular_band`, `circular_band`, `vertical_s`, `horizontal_s` |
| `--position` | `-p` | 位置参数（仅垂直/水平切片有效） | `"center"` | `left`/`center`/`right`/`top`/`bottom` 或 0.0-1.0 |
| `--linear` | `-l` | 启用线性模式 | 关闭 | - |
| `--reverse` | `-r` | 逆序排序图片 | 关闭 | - |
| `--sort-by` | - | 排序方式 | `"name"` | `name`, `created_time`, `modified_time` |
| `--output-name` | - | 输出文件基础名称 | `"timeslice"` | 任何字符串 |
| `--include-timestamp` | - | 在文件名中包含时间戳 | 关闭 | - |
| `--include-slice-type` | - | 在文件名中包含切片类型 | 关闭 | - |
| `--extension` | - | 输出文件扩展名 | `"jpg"` | `jpg`, `jpeg`, `png`, `webp` |
| `--language` | `-lang` | 界面语言 | `"en"` | `en`, `zh_CN` |

## 切片类型详细说明

### 1. 垂直切片 (`vertical`)
- **描述**：将图片按垂直方向分割，每张图片取一个垂直条带
- **线性模式**：条带从左到右线性移动
- **位置选项**：左侧、居中、右侧

### 2. 水平切片 (`horizontal`)
- **描述**：将图片按水平方向分割，每张图片取一个水平条带
- **线性模式**：条带从上到下线性移动
- **位置选项**：顶部、居中、底部

### 3. 圆形扇形切片 (`circular_sector`)
- **描述**：以图片中心为圆心，将360度等分成多个扇形
- **线性模式**：扇形半径从中心到边缘线性缩放
- **位置选项**：居中（固定）

### 4. 椭圆形扇形切片 (`elliptical_sector`)
- **描述**：以图片中心为中心，将整个椭圆等分成多个扇形
- **线性模式**：椭圆半轴从中心到边缘线性缩放
- **位置选项**：居中（固定）

### 5. 椭圆形环带切片 (`elliptical_band`)
- **描述**：生成同心椭圆环带，从中心向外扩展
- **线性模式**：不支持（环带按平方根规律扩展）
- **位置选项**：居中（固定）

### 6. 矩形环带切片 (`rectangular_band`)
- **描述**：生成同心矩形环带，从中心向外扩展
- **线性模式**：不支持（环带按平方根规律扩展）
- **位置选项**：居中（固定）

### 7. 圆形环带切片 (`circular_band`)
- **描述**：生成同心圆环带，从中心向外扩展
- **线性模式**：不支持（环带按平方根规律扩展）
- **位置选项**：居中（固定）

### 8. 垂直S型曲线 (`vertical_s`)
- **描述**：图片沿垂直方向的S形曲线无缝拼接
- **线性模式**：不支持（S形曲线已预设拼接路径）
- **位置选项**：居中（固定）

### 9. 水平S型曲线 (`horizontal_s`)
- **描述**：图片沿水平方向的S形曲线无缝拼接
- **线性模式**：不支持（S形曲线已预设拼接路径）
- **位置选项**：居中（固定）

## 线性模式详细说明

| 切片类型 | 线性模式名称 | 作用描述 |
|----------|--------------|----------|
| **垂直切片** | 条带位置线性变化 | 启用：条带从左到右线性移动<br>禁用：条带在固定位置 |
| **水平切片** | 条带位置线性变化 | 启用：条带从上到下线性移动<br>禁用：条带在固定位置 |
| **圆形扇形** | 扇形半径线性缩放 | 启用：扇形半径从中心到边缘线性变化<br>禁用：所有扇形使用最大半径 |
| **椭圆形扇形** | 椭圆半轴线性缩放 | 启用：椭圆半轴从中心到边缘线性变化<br>禁用：所有扇形使用最大半轴 |
| **环带类型** | （不支持） | 环带从中心向外扩展，形成同心效果 |
| **S型曲线** | （不支持） | 图片沿S形曲线无缝拼接 |

## 输出文件命名示例

### 命名规则：
`基础名称`-[`时间`]-[`切片类型`].`扩展名`

### 示例：
- `timeslice-20231220_143000-垂直.jpg`
- `vacation-水平S型.png`
- `sunset-20231220_150000-圆形扇形.webp`
- `mountain-矩形环带.jpg`

## 项目结构
```
PhotoTimeSlice/
├── cli.py                    # 命令行接口
├── gui.py                    # 图形界面
├── i18n.py                   # 国际化翻译
├── utils.py                  # 工具函数（图片加载、排序等）
├── languages/               # 语言文件目录
│   ├── en.locpak           # 英文翻译
│   └── zh_CN.locpak        # 中文翻译
├── slices/                  # 切片算法目录
│   ├── __init__.py
│   ├── vertical_slice.py
│   ├── horizontal_slice.py
│   ├── circular_sector_slice.py
│   ├── elliptical_sector_slice.py
│   ├── elliptical_band_slice.py
│   ├── rectangular_band_slice.py
│   ├── circular_band_slice.py
│   ├── vertical_s_slice.py
│   └── horizontal_s_slice.py
├── README.md                # 说明文档
└── LICENSE                  # 许可证
```

## 注意事项

1. **图片尺寸**：输入目录中的图片需为同一尺寸，否则会提示错误
2. **图片质量**：推荐使用连续拍摄的照片（如延时摄影），效果最佳
3. **文件格式**：
   - 基础格式：JPG/PNG/TIF/JPEG
   - RAW格式：NEF/CR2/ARW/DNG（需安装rawpy库）
4. **线性模式**：仅在特定切片类型中有效，具体作用见上表
5. **位置选项**：根据切片类型自动调整为相应选项
6. **文件名长度**：Windows系统限制最大260字符，请合理设置文件名

---

**适用场景**：延时摄影、时间序列分析、艺术创作、教学演示等

**推荐用途**：城市变化记录、自然景观变化、创意摄影等

如需帮助或有建议，请提交Issue。